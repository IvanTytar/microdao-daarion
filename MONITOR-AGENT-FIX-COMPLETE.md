# ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è Monitor Agent - –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –∑–º—ñ–Ω–∏ –Ω–∞ –ù–û–î–ê1 —Ç–∞ –ù–û–î–ê2

**–î–∞—Ç–∞:** 2025-11-23  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ

---

## üîç –ü—Ä–æ–±–ª–µ–º–∞

Monitor Agent –Ω–µ –ø–∏—Å–∞–≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –∑–º—ñ–Ω–∏ –Ω–∞ –ù–û–î–ê1 —Ç–∞ –ù–û–î–ê2 —É –¥—ñ–∞–ª–æ–≥–æ–≤–µ –≤—ñ–∫–Ω–æ.

## üîß –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

### 1. –í–∏–¥–∞–ª–µ–Ω–æ –¥—É–±–ª—é–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å

**–§–∞–π–ª:** `src/pages/DagiMonitorPage.tsx`

- ‚ùå –í–∏–¥–∞–ª–µ–Ω–æ –∫–æ–¥, —è–∫–∏–π –¥–æ–¥–∞–≤–∞–≤ –ø–æ–¥—ñ—ó –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ —á–∞—Ç
- ‚úÖ –¢–µ–ø–µ—Ä —Ç—ñ–ª—å–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ Monitor Agent –¥–æ–¥–∞—é—Ç—å—Å—è –≤ —á–∞—Ç
- ‚úÖ –í—Å—ñ –ø–æ–¥—ñ—ó –∑ –Ω–æ–¥ –∫–æ–Ω–≤–µ—Ä—Ç—É—é—Ç—å—Å—è –≤ `ProjectChange` —ñ –≥–µ–Ω–µ—Ä—É—é—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ Monitor Agent

### 2. –ü–æ–∫—Ä–∞—â–µ–Ω–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è

**–§–∞–π–ª–∏:**
- `src/pages/DagiMonitorPage.tsx`
- `src/services/projectChangeTracker.ts`

**–î–æ–¥–∞–Ω–æ:**
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó –ø–æ–¥—ñ–π
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —á–µ—Ä–µ–∑ Monitor Agent
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤ —á–∞—Ç

### 3. –ü–æ–∫—Ä–∞—â–µ–Ω–æ –æ–±—Ä–æ–±–∫—É –ø–æ–º–∏–ª–æ–∫

**–§–∞–π–ª:** `src/services/projectChangeTracker.ts`

- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
- ‚úÖ Fallback –Ω–∞ –±–∞–∑–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —è–∫—â–æ Monitor Agent API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –∫—Ä–æ–∫—ñ–≤ –ø—Ä–æ—Ü–µ—Å—É

---

## üîÑ –Ø–∫ –ø—Ä–∞—Ü—é—î —Å–∏—Å—Ç–µ–º–∞

### 1. –ü–æ–¥—ñ—ó –∑ –Ω–æ–¥ (WebSocket)

```
–ó–º—ñ–Ω–∞ –Ω–∞ –ù–û–î–ê1/–ù–û–î–ê2
    ‚Üì
WebSocket –ø–æ–¥—ñ—è (useMonitorEvents)
    ‚Üì
–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –≤ ProjectChange
    ‚Üì
–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ Monitor Agent (Mistral –Ω–∞ –ù–û–î–ê2)
    ‚Üì
CustomEvent 'project-change'
    ‚Üì
–î–æ–¥–∞–≤–∞–Ω–Ω—è –≤ —á–∞—Ç
```

### 2. –õ–∞–Ω—Ü—é–∂–æ–∫ –æ–±—Ä–æ–±–∫–∏

1. **–ü–æ–¥—ñ—è –∑ –Ω–æ–¥–∏** ‚Üí `useMonitorEvents` –æ—Ç—Ä–∏–º—É—î —á–µ—Ä–µ–∑ WebSocket
2. **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è** ‚Üí –ü–æ–¥—ñ—è –∫–æ–Ω–≤–µ—Ä—Ç—É—î—Ç—å—Å—è –≤ `ProjectChange`
3. **–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è** ‚Üí Monitor Agent (Mistral) –≥–µ–Ω–µ—Ä—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
4. **CustomEvent** ‚Üí `emitChangeEvent` –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –ø–æ–¥—ñ—é
5. **–ß–∞—Ç** ‚Üí `handleProjectChange` –¥–æ–¥–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ —á–∞—Ç

---

## üìã –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

### 1. –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)

–ú–∞—î –±—É—Ç–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è:
```
üìä New monitor event received: {type: 'node', ...}
üîÑ Converting monitor event to ProjectChange for Monitor Agent: ...
‚úÖ Event converted to ProjectChange, Monitor Agent will generate message
ü§ñ Generating Monitor Agent message for change: ...
üì° Sending to Monitor Agent API: ...
‚úÖ Monitor Agent message generated: ...
üì¢ Dispatching CustomEvent project-change
‚úÖ CustomEvent dispatched successfully
üìù Project change event received from Monitor Agent: ...
‚úÖ Adding Monitor Agent message to chat: ...
```

### 2. WebSocket –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

- –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä —É header —á–∞—Ç—É –º–∞—î –±—É—Ç–∏ –∑–µ–ª–µ–Ω–∏–º
- –ö–æ–Ω—Å–æ–ª—å: `Monitor WebSocket connected`

### 3. Monitor Agent Service

- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –ø—Ä–∞—Ü—é—î –Ω–∞ `http://localhost:9500`
- Health check: `GET http://localhost:9500/health`

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ –ü–æ–¥—ñ—ó –∑ –Ω–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≥–µ–Ω–µ—Ä—É—é—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ Monitor Agent
- ‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ–¥–∞—é—Ç—å—Å—è –≤ —á–∞—Ç —á–µ—Ä–µ–∑ CustomEvent
- ‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –≤ —á–∞—Ç—ñ
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

**–ì–æ—Ç–æ–≤–æ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è!** üöÄ

