# ‚úÖ Monitor Agent - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —Å–∏—Å—Ç–µ–º–æ—é

**–î–∞—Ç–∞:** 2025-11-22  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

---

## üéâ –í–∏–∫–æ–Ω–∞–Ω–æ

### ‚úÖ 1. Event Logging System
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –∑–º—ñ–Ω –≤ —Å–∏—Å—Ç–µ–º—ñ
- ‚úÖ –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –æ—Å—Ç–∞–Ω–Ω—ñ—Ö 1000 –ø–æ–¥—ñ–π
- ‚úÖ –¢–∏–ø–∏ –ø–æ–¥—ñ–π: `node`, `agent`, `system`
- ‚úÖ –î—ñ—ó: `created`, `updated`, `deleted`, `status_changed`, `swapper_updated`

### ‚úÖ 2. Real-time Updates
- ‚úÖ WebSocket endpoint: `/ws/events`
- ‚úÖ Server-Sent Events: `/api/events/stream`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è Monitor Agent –¥–æ –ø–æ–¥—ñ–π
- ‚úÖ Broadcast –ø–æ–¥—ñ–π –≤—Å—ñ–º –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∞–º

### ‚úÖ 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ Background task –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –∑–º—ñ–Ω
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É –Ω–æ–¥ –∫–æ–∂–Ω—ñ 30 —Å–µ–∫—É–Ω–¥
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Swapper Service –∫–æ–∂–Ω—ñ 30 —Å–µ–∫—É–Ω–¥
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è –∑–º—ñ–Ω

### ‚úÖ 4. Event Log –Ω–∞ Dashboard
- ‚úÖ –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –æ—Å—Ç–∞–Ω–Ω—ñ—Ö 20 –ø–æ–¥—ñ–π
- ‚úÖ Real-time –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ WebSocket
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–∂–Ω—ñ 10 —Å–µ–∫—É–Ω–¥
- ‚úÖ –í—ñ–∑—É–∞–ª—å–Ω—ñ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –ø–æ–¥—ñ–π

---

## üöÄ –Ø–∫ –ø—Ä–∞—Ü—é—î

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π

1. **–ó–º—ñ–Ω–∏ –≤ –∞–≥–µ–Ω—Ç–∞—Ö:**
   - –°—Ç–≤–æ—Ä–µ–Ω–Ω—è/–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–≥–µ–Ω—Ç–∞
   - –î–æ–¥–∞–≤–∞–Ω–Ω—è/–≤–∏–¥–∞–ª–µ–Ω–Ω—è –∞–≥–µ–Ω—Ç–∞ –∑ –∫–æ–º–∞–Ω–¥–∏
   - –ó–º—ñ–Ω–∞ system prompt

2. **–ó–º—ñ–Ω–∏ –≤ –Ω–æ–¥–∞—Ö:**
   - –ó–º—ñ–Ω–∞ —Å—Ç–∞—Ç—É—Å—É –Ω–æ–¥–∏ (online/offline/degraded)
   - –û–Ω–æ–≤–ª–µ–Ω–Ω—è Swapper Service
   - –ó–º—ñ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—ó –º–æ–¥–µ–ª—ñ

3. **–°–∏—Å—Ç–µ–º–Ω—ñ –ø–æ–¥—ñ—ó:**
   - –ó–∞–ø—É—Å–∫/–∑—É–ø–∏–Ω–∫–∞ Monitor Agent
   - –û—á–∏—â–µ–Ω–Ω—è –ª–æ–≥—É
   - –Ü–Ω—à—ñ —Å–∏—Å—Ç–µ–º–Ω—ñ –ø–æ–¥—ñ—ó

### Real-time –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

1. **WebSocket –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ dashboard
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø—Ä–∏ —Ä–æ–∑—Ä–∏–≤—ñ
   - Broadcast –Ω–æ–≤–∏—Ö –ø–æ–¥—ñ–π –≤—Å—ñ–º –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∞–º

2. **Event Stream:**
   - Server-Sent Events –¥–ª—è fallback
   - –û—Å—Ç–∞–Ω–Ω—ñ 20 –ø–æ–¥—ñ–π –ø—Ä–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—ñ
   - –ù–æ–≤—ñ –ø–æ–¥—ñ—ó –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

---

## üìä Event Log –Ω–∞ Dashboard

### –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è

1. **–°–µ–∫—Ü—ñ—è "System Activity Log":**
   - –û—Å—Ç–∞–Ω–Ω—ñ 20 –ø–æ–¥—ñ–π
   - Real-time –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
   - –í—ñ–∑—É–∞–ª—å–Ω—ñ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏:
     - üîµ Agent events (blue)
     - üü¢ Node events (green)
     - üü£ System events (purple)

2. **–§–æ—Ä–º–∞—Ç –ø–æ–¥—ñ—ó:**
   - –Ü–∫–æ–Ω–∫–∞ —Ç–∏–ø—É –ø–æ–¥—ñ—ó
   - –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
   - –ß–∞—Å –ø–æ–¥—ñ—ó
   - –î–µ—Ç–∞–ª—ñ (—è–∫—â–æ —î)

3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:**
   - WebSocket –¥–ª—è real-time
   - Polling –∫–æ–∂–Ω—ñ 10 —Å–µ–∫—É–Ω–¥ (fallback)
   - –ê–Ω—ñ–º–∞—Ü—ñ—è –Ω–æ–≤–∏—Ö –ø–æ–¥—ñ–π

---

## üîß API Endpoints

### Events API

```bash
# –û—Ç—Ä–∏–º–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ –ø–æ–¥—ñ—ó
GET /api/events?limit=50

# WebSocket –¥–ª—è real-time
WS /ws/events

# Server-Sent Events
GET /api/events/stream

# –û—á–∏—Å—Ç–∏—Ç–∏ –ª–æ–≥
POST /api/events/clear
```

### –ü—Ä–∏–∫–ª–∞–¥ –ø–æ–¥—ñ—ó

```json
{
  "timestamp": "2025-11-22T12:34:56.789",
  "type": "agent",
  "action": "sub_agent_added",
  "message": "–î–æ–¥–∞–Ω–æ –∞–≥–µ–Ω—Ç–∞ 'Product Manager' –≤ –∫–æ–º–∞–Ω–¥—É GREENFOOD Assistant",
  "details": {
    "agent_id": "greenfood",
    "agent_name": "GREENFOOD Assistant",
    "sub_agent": {
      "name": "Product Manager",
      "role": "Manages products"
    }
  }
}
```

---

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞

### 1. –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –Ω–æ–¥
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É –∫–æ–∂–Ω—ñ 30 —Å–µ–∫—É–Ω–¥
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω —Å—Ç–∞—Ç—É—Å—É
- ‚úÖ –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è Swapper Service

### 2. –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –∞–≥–µ–Ω—Ç—ñ–≤
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –∑–º—ñ–Ω –≤ –∞–≥–µ–Ω—Ç–∞—Ö
- ‚úÖ –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∑–º—ñ–Ω –≤ –∫–æ–º–∞–Ω–¥–∞—Ö –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω—å system prompt

### 3. –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ Swapper Service
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–æ–∂–Ω—ñ 30 —Å–µ–∫—É–Ω–¥
- ‚úÖ –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∑–º—ñ–Ω –∞–∫—Ç–∏–≤–Ω–æ—ó –º–æ–¥–µ–ª—ñ
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω—å

---

## üìã –¢–∏–ø–∏ –ø–æ–¥—ñ–π

### Agent Events
- `created` - –°—Ç–≤–æ—Ä–µ–Ω–æ –∞–≥–µ–Ω—Ç–∞
- `updated` - –û–Ω–æ–≤–ª–µ–Ω–æ –∞–≥–µ–Ω—Ç–∞
- `sub_agent_added` - –î–æ–¥–∞–Ω–æ –∞–≥–µ–Ω—Ç–∞ –≤ –∫–æ–º–∞–Ω–¥—É
- `sub_agent_removed` - –í–∏–¥–∞–ª–µ–Ω–æ –∞–≥–µ–Ω—Ç–∞ –∑ –∫–æ–º–∞–Ω–¥–∏

### Node Events
- `status_changed` - –ó–º—ñ–Ω–µ–Ω–æ —Å—Ç–∞—Ç—É—Å –Ω–æ–¥–∏
- `swapper_updated` - –û–Ω–æ–≤–ª–µ–Ω–æ Swapper Service
- `model_changed` - –ó–º—ñ–Ω–µ–Ω–æ –∞–∫—Ç–∏–≤–Ω—É –º–æ–¥–µ–ª—å

### System Events
- `monitor_started` - –ó–∞–ø—É—â–µ–Ω–æ Monitor Agent
- `log_cleared` - –û—á–∏—â–µ–Ω–æ –ª–æ–≥ –ø–æ–¥—ñ–π

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### 1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ Event Log

```bash
# –û—Ç—Ä–∏–º–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ –ø–æ–¥—ñ—ó
curl http://localhost:8899/api/events?limit=10
```

### 2. –¢–µ—Å—Ç—É–≤–∞—Ç–∏ WebSocket

```javascript
const ws = new WebSocket('ws://localhost:8899/ws/events');
ws.onmessage = (event) => {
    console.log('Event:', JSON.parse(event.data));
};
```

### 3. –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤—É –ø–æ–¥—ñ—é

- –î–æ–¥–∞—Ç–∏ –∞–≥–µ–Ω—Ç–∞ –≤ –∫–æ–º–∞–Ω–¥—É –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –ó–º—ñ–Ω–∏—Ç–∏ system prompt –∞–≥–µ–Ω—Ç–∞
- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ Event Log

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

**Monitor Agent –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–æ –∑ —Å–∏—Å—Ç–µ–º–æ—é!** üéâ

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –∑–º—ñ–Ω
- ‚úÖ Real-time –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ WebSocket
- ‚úÖ Event Log –Ω–∞ dashboard
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –Ω–æ–¥ —Ç–∞ –∞–≥–µ–Ω—Ç—ñ–≤
- ‚úÖ Background task –¥–ª—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∑–º—ñ–Ω

**–ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä—è–º–æ –∑–∞—Ä–∞–∑!**

---

**Last Updated:** 2025-11-22  
**Status:** ‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è  
**URL:** `http://localhost:8899`

