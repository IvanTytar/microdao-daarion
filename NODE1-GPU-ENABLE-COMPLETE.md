# ‚úÖ –£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è GPU –¥–ª—è Ollama –Ω–∞ –ù–û–î–ê1 - –ó–∞–≤–µ—Ä—à–µ–Ω–æ

**–î–∞—Ç–∞:** 2025-01-27  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–∏–∫–æ–Ω–∞–Ω–æ

---

## üéØ –í–∏–∫–æ–Ω–∞–Ω—ñ –¥—ñ—ó

### 1. –°—Ç–≤–æ—Ä–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Å–∫—Ä–∏–ø—Ç
- ‚úÖ `NODE1-OLLAMA-GPU-ENABLE.sh` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è —É–≤—ñ–º–∫–Ω–µ–Ω–Ω—è GPU
- ‚úÖ –°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ –Ω–∞ –ù–û–î–ê1: `/opt/microdao-daarion/`

### 2. –ù–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ GPU –¥–ª—è Ollama
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ `/etc/systemd/system/ollama.service.d/override.conf`
- ‚úÖ –î–æ–¥–∞–Ω–æ environment variables:
  - `OLLAMA_NUM_GPU=1`
  - `OLLAMA_GPU_LAYERS=35`
  - `CUDA_VISIBLE_DEVICES=0`
  - `OLLAMA_KEEP_ALIVE=24h`

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–æ Ollama
- ‚úÖ `systemctl daemon-reload`
- ‚úÖ `systemctl restart ollama`

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

### –î–æ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó:
- **CPU:** 85.3%
- **GPU utilization:** 0%
- **Ollama CPU:** 1583% (multi-core)

### –ü—ñ—Å–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó:
- **CPU:** 85.6% (—Ç–∏–º—á–∞—Å–æ–≤–æ –≤–∏—Å–æ–∫–µ, –ø–æ–∫–∏ –º–æ–¥–µ–ª—å –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è)
- **GPU utilization:** 0% (–ø–æ–∫–∏ –º–æ–¥–µ–ª—å –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞)
- **GPU memory:** 7848 MiB / 20475 MiB (38%) - –º–æ–¥–µ–ª—å –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –Ω–∞ GPU! ‚úÖ
- **Ollama CPU:** 0.4% (–∑–Ω–∞—á–Ω–æ –∑–Ω–∏–∑–∏–ª–æ—Å—è –ø—ñ—Å–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É)
- **Ollama service:** ‚úÖ –ê–∫—Ç–∏–≤–Ω–∏–π –∑ GPU environment variables

---

## üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

### GPU —Å—Ç–∞—Ç—É—Å:
```bash
nvidia-smi
# –ú–∞—î –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ Ollama –ø—Ä–æ—Ü–µ—Å–∏ –Ω–∞ GPU
```

### Ollama —Å—Ç–∞—Ç—É—Å:
```bash
systemctl status ollama
curl http://localhost:11434/api/ps
```

### CPU –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:
```bash
top -bn1 | grep "Cpu(s)"
# –ú–∞—î –∑–Ω–∏–∑–∏—Ç–∏—Å—è –∑ 85.3% –¥–æ 40-50%
```

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

### –í–∏–∫–æ–Ω–∞–Ω–æ:
1. ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ `/etc/systemd/system/ollama.service.d/override.conf` –∑ GPU –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏
2. ‚úÖ –î–æ–¥–∞–Ω–æ environment variables: `OLLAMA_NUM_GPU=1`, `OLLAMA_GPU_LAYERS=35`, `CUDA_VISIBLE_DEVICES=0`
3. ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–æ Ollama service
4. ‚úÖ GPU memory –∑–±—ñ–ª—å—à–∏–ª–∞—Å—è –∑ 2246 MiB –¥–æ 7848 MiB (–º–æ–¥–µ–ª—å –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –Ω–∞ GPU!)

### –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:
1. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –º–æ–¥–µ–ª—å –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è: `ollama run qwen3:8b "test"`
2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ GPU utilization –ø—ñ–¥ —á–∞—Å —Ä–æ–±–æ—Ç–∏ –º–æ–¥–µ–ª—ñ
3. –ú–æ–Ω—ñ—Ç–æ—Ä–∏—Ç–∏ CPU –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (–º–∞—î –∑–Ω–∏–∑–∏—Ç–∏—Å—è –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ –Ω–∞ GPU)

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ –Ω–∞ GPU, CPU –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–∞—î –∑–Ω–∏–∑–∏—Ç–∏—Å—è –∑ 85.3% –¥–æ 40-50%

---

**Last Updated:** 2025-01-27  
**Status:** ‚úÖ –í–∏–∫–æ–Ω–∞–Ω–æ, GPU –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ, –º–æ–¥–µ–ª—å –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –Ω–∞ GPU

