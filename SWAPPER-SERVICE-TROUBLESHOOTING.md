# üîß Troubleshooting Swapper Service

**–î–∞—Ç–∞:** 2025-11-23  
**–ü—Ä–æ–±–ª–µ–º–∞:** Swapper Service –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ –ù–û–î–ê1

---

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

**–°–∏–º–ø—Ç–æ–º–∏:**
- Swapper Service –ø–æ–∫–∞–∑—É—î "–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π" –≤ –∫–∞–±—ñ–Ω–µ—Ç—ñ –ù–û–î–ê1
- URL: `http://144.76.224.179:8890`
- –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å–ø—Ä–æ–±—ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å—Ç–∞—Ç—É—Å

---

## üîç –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### 1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –∑–∞–ø—É—â–µ–Ω–∏–π Swapper Service –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

```bash
# SSH –¥–æ –ù–û–î–ê1
ssh root@144.76.224.179

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker ps | grep swapper

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏
docker logs swapper-service --tail 50

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å
docker inspect swapper-service | grep Status
```

### 2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ health endpoint

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ
curl http://localhost:8890/health

# –ó –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–∞—à–∏–Ω–∏ (—è–∫—â–æ —Ñ–∞–π—Ä–≤–æ–ª –¥–æ–∑–≤–æ–ª—è—î)
curl http://144.76.224.179:8890/health
```

### 3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–æ—Ä—Ç —Ç–∞ –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ
netstat -tuln | grep 8890
ss -tuln | grep 8890

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ñ–∞–π—Ä–≤–æ–ª
ufw status
iptables -L -n | grep 8890
```

### 4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ docker-compose

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ
cd /opt/microdao-daarion
docker-compose ps swapper-service
docker-compose logs swapper-service
```

---

## üîß –†—ñ—à–µ–Ω–Ω—è

### –í–∞—Ä—ñ–∞–Ω—Ç 1: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –∑–∞–ø—É—â–µ–Ω–∏–π Swapper Service

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ
ssh root@144.76.224.179

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker ps | grep swapper

# –Ø–∫—â–æ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∏–π - –∑–∞–ø—É—Å—Ç–∏—Ç–∏
cd /opt/microdao-daarion
docker-compose up -d swapper-service

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏
docker-compose logs swapper-service --tail 50
```

### –í–∞—Ä—ñ–∞–Ω—Ç 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ Swapper Service

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ
cd /opt/microdao-daarion
docker-compose restart swapper-service

# –ê–±–æ –ø–æ–≤–Ω–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose down swapper-service
docker-compose up -d swapper-service
```

### –í–∞—Ä—ñ–∞–Ω—Ç 3: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ endpoints

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ
# –ë–∞–∑–æ–≤–∏–π health endpoint (–º–∞—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏)
curl http://localhost:8890/health

# –ë–∞–∑–æ–≤–∏–π status endpoint (–º–∞—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏)
curl http://localhost:8890/status

# Cabinet API endpoint (–º–æ–∂–µ –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏, —è–∫—â–æ router –Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π)
curl http://localhost:8890/api/cabinet/swapper/status
```

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** –Ø–∫—â–æ `/api/cabinet/swapper/status` –ø–æ–≤–µ—Ä—Ç–∞—î 404, –∞–ª–µ `/status` –ø—Ä–∞—Ü—é—î - —Ü–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. Frontend –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î –±–∞–∑–æ–≤–∏–π endpoint —è–∫ fallback.

### –í–∞—Ä—ñ–∞–Ω—Ç 2: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ
cd /opt/microdao-daarion
cat docker-compose.yml | grep -A 20 swapper-service
```

### –í–∞—Ä—ñ–∞–Ω—Ç 3: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ñ–∞–π—Ä–≤–æ–ª

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ
# –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è ufw
ufw allow 8890/tcp

# –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è iptables
iptables -A INPUT -p tcp --dport 8890 -j ACCEPT
```

### –í–∞—Ä—ñ–∞–Ω—Ç 4: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ CORS –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–Ø–∫—â–æ Swapper Service –ø—Ä–∞—Ü—é—î, –∞–ª–µ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑ –±—Ä–∞—É–∑–µ—Ä–∞, –º–æ–∂–ª–∏–≤–∞ –ø—Ä–æ–±–ª–µ–º–∞ –∑ CORS:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ, –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è CORS –≤ Swapper Service
docker exec swapper-service cat /app/config.py | grep CORS
```

---

## üìä –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–¥—É

### –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫

**–§–∞–π–ª:** `src/components/swapper/SwapperComponents.tsx`

**–ó–º—ñ–Ω–∏:**
- ‚úÖ –ó–±—ñ–ª—å—à–µ–Ω–æ —Ç–∞–π–º–∞—É—Ç –¥–æ 10 —Å–µ–∫—É–Ω–¥
- ‚úÖ –î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É health endpoint –ø–µ—Ä–µ–¥ –æ—Å–Ω–æ–≤–Ω–∏–º –∑–∞–ø–∏—Ç–æ–º
- ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏ –∑ –¥–µ—Ç–∞–ª—å–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é
- ‚úÖ –î–æ–¥–∞–Ω–æ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

**–§–∞–π–ª:** `src/components/swapper/SwapperDetailedMetrics.tsx`

**–ó–º—ñ–Ω–∏:**
- ‚úÖ –î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É health endpoint
- ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω–æ –æ–±—Ä–æ–±–∫—É –ø–æ–º–∏–ª–æ–∫
- ‚úÖ –î–æ–¥–∞–Ω–æ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

## ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

1. **–í—ñ–¥–∫—Ä–∏—Ç–∏ –∫–∞–±—ñ–Ω–µ—Ç –ù–û–î–ê1:**
   ```
   http://localhost:8899/nodes/node-1-hetzner-gex44
   ```

2. **–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–°–µ—Ä–≤—ñ—Å–∏"**

3. **–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ Swapper Service:**
   - –ú–∞—î –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—è —Å—Ç–∞—Ç—É—Å –∞–±–æ –¥–µ—Ç–∞–ª—å–Ω–∞ –ø–æ–º–∏–ª–∫–∞
   - –Ø–∫—â–æ –ø–æ–º–∏–ª–∫–∞ - —Å–ª—ñ–¥—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º –≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ

---

## üéØ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

1. **–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ:**
   ```bash
   ssh root@144.76.224.179 "docker ps | grep swapper"
   ssh root@144.76.224.179 "curl http://localhost:8890/health"
   ```

2. **–Ø–∫—â–æ —Å–µ—Ä–≤—ñ—Å –Ω–µ –∑–∞–ø—É—â–µ–Ω–∏–π:**
   ```bash
   ssh root@144.76.224.179 "cd /opt/microdao-daarion && docker-compose up -d swapper-service"
   ```

3. **–Ø–∫—â–æ —Å–µ—Ä–≤—ñ—Å –ø—Ä–∞—Ü—é—î, –∞–ª–µ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∑–æ–≤–Ω—ñ:**
   - –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ñ–∞–π—Ä–≤–æ–ª
   - –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ
   - –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ CORS –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

---

## üìù –ü—Ä–∏–º—ñ—Ç–∫–∏

- Swapper Service –º–∞—î –±—É—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ –ø–æ—Ä—Ç—É 8890
- Health endpoint: `http://144.76.224.179:8890/health`
- Status endpoint: `http://144.76.224.179:8890/api/cabinet/swapper/status`
- –Ø–∫—â–æ —Å–µ—Ä–≤—ñ—Å –ø—Ä–∞—Ü—é—î –ª–æ–∫–∞–ª—å–Ω–æ, –∞–ª–µ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∑–æ–≤–Ω—ñ - –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ñ–∞–π—Ä–≤–æ–ª—ñ –∞–±–æ –º–µ—Ä–µ–∂–µ–≤–∏—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö

---

**–û–Ω–æ–≤–ª–µ–Ω–æ:** 2025-11-23

