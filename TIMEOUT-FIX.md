# –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —Ç–∞–π–º–∞—É—Ç—É –¥–ª—è —á–∞—Ç—É –∑ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏

**–î–∞—Ç–∞:** 2025-11-23  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ

---

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–ê–≥–µ–Ω—Ç–∏ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª–∏ —É —á–∞—Ç—ñ - —Å–ø—ñ–Ω–µ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫—Ä—É—Ç–∏–≤—Å—è, –∞–ª–µ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–µ –±—É–ª–æ.

### –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

1. **Router –ø—Ä–∞—Ü—é—î –∫–æ—Ä–µ–∫—Ç–Ω–æ**:
   ```
   Request successful via llm_local_qwen3_8b
   Tokens: 416
   Response: "–Ø ‚Äî GREENFOOD, AI-ERP –¥–ª—è –∫—Ä–∞—Ñ—Ç–æ–≤–∏—Ö –≤–∏—Ä–æ–±–Ω–∏–∫—ñ–≤..."
   ```

2. **–ó–∞–ø–∏—Ç –∑–∞–π–º–∞—î 18 —Å–µ–∫—É–Ω–¥**:
   ```bash
   $ curl -v http://144.76.224.179:9102/route ...
   # Transfer time: 18 seconds
   HTTP/1.1 200 OK
   ```

3. **–¢–∞–π–º–∞—É—Ç frontend: 15 —Å–µ–∫—É–Ω–¥**:
   ```typescript
   const timeoutId = setTimeout(() => controller.abort(), 15000); // ‚ùå –ó–∞–Ω–∞–¥—Ç–æ –∫–æ—Ä–æ—Ç–∫–∏–π
   ```

### –ü—Ä–∏—á–∏–Ω–∞

LLM (qwen3:8b) –æ–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç ~8-10 —Å–µ–∫—É–Ω–¥, –ø–ª—é—Å –º–µ—Ä–µ–∂–Ω—ñ –∑–∞—Ç—Ä–∏–º–∫–∏, —â–æ —Ä–∞–∑–æ–º –¥–∞—î 15-20 —Å–µ–∫—É–Ω–¥. Frontend —Ç–∞–π–º–∞—É—Ç —Å–ø—Ä–∞—Ü—å–æ–≤—É—î —Ä–∞–Ω—ñ—à–µ, –Ω—ñ–∂ –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å.

---

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è

### –ó–±—ñ–ª—å—à–µ–Ω–æ —Ç–∞–π–º–∞—É—Ç –¥–æ 30 —Å–µ–∫—É–Ω–¥

**–§–∞–π–ª:** `src/components/microdao/MicroDaoOrchestratorChat.tsx`

```typescript
// –î–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è
const timeoutId = setTimeout(() => controller.abort(), 15000); // ‚ùå 15 —Å–µ–∫—É–Ω–¥

// –ü—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è
const timeoutId = setTimeout(() => controller.abort(), 30000); // ‚úÖ 30 —Å–µ–∫—É–Ω–¥
```

### –û–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è —á–∞—Å—É

- **LLM –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è**: 8-10 —Å–µ–∫—É–Ω–¥ (qwen3:8b –Ω–∞ CPU/GPU)
- **–ú–µ—Ä–µ–∂–Ω—ñ –∑–∞—Ç—Ä–∏–º–∫–∏**: 2-3 —Å–µ–∫—É–Ω–¥–∏
- **Router –æ–±—Ä–æ–±–∫–∞**: 1-2 —Å–µ–∫—É–Ω–¥–∏
- **–ó–∞–ø–∞—Å**: 5-10 —Å–µ–∫—É–Ω–¥ –¥–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤

**–†–∞–∑–æ–º:** ~20-25 —Å–µ–∫—É–Ω–¥ –º–∞–∫—Å–∏–º—É–º, —Ç–∞–π–º–∞—É—Ç 30 —Å–µ–∫—É–Ω–¥ - –±–µ–∑–ø–µ—á–Ω–∏–π –∑–∞–ø–∞—Å.

---

## üìä –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

### –ß–∞—Å –æ–±—Ä–æ–±–∫–∏ –∑–∞–ø–∏—Ç—ñ–≤ (—Å–µ—Ä–µ–¥–Ω—ñ–π)

| –ê–≥–µ–Ω—Ç | Prompt Tokens | Completion Tokens | –ß–∞—Å –æ–±—Ä–æ–±–∫–∏ |
|-------|---------------|-------------------|-------------|
| GREENFOOD | 43 | 373 | 8-9 —Å–µ–∫ |
| Helion | 45 | 250 | 6-7 —Å–µ–∫ |
| Yaromir | 50 | 300 | 7-8 —Å–µ–∫ |
| DAARWIZZ | 40 | 200 | 5-6 —Å–µ–∫ |

### –ß–æ–º—É –ø–æ–≤—ñ–ª—å–Ω–æ?

1. **–ú–æ–¥–µ–ª—å qwen3:8b** –ø—Ä–∞—Ü—é—î –Ω–∞ CPU (–±–µ–∑ GPU acceleration –Ω–∞ –ø–æ–≤–Ω—É):
   - GPU layers: 35 (—á–∞—Å—Ç–∫–æ–≤–æ)
   - –ß–∞—Å—Ç–∏–Ω–∞ —à–∞—Ä—ñ–≤ –Ω–∞ CPU

2. **Ollama keep_alive**: 24h
   - –ú–æ–¥–µ–ª—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞ –≤ –ø–∞–º'—è—Ç—å
   - –ê–ª–µ –ø–µ—Ä—à–∏–π –∑–∞–ø–∏—Ç –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–∏–º

3. **–ú–µ—Ä–µ–∂–Ω—ñ –∑–∞—Ç—Ä–∏–º–∫–∏**:
   - Docker network overhead
   - Router ‚Üí Ollama –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó (–º–∞–π–±—É—Ç–Ω—î)

### 1. GPU Acceleration (—è–∫—â–æ –¥–æ—Å—Ç—É–ø–Ω–∏–π)
```bash
# –ü–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ Ollama –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î GPU –ø–æ–≤–Ω—ñ—Å—Ç—é
Environment="OLLAMA_NUM_GPU=1"
Environment="OLLAMA_GPU_LAYERS=99"  # –í—Å—ñ —à–∞—Ä–∏ –Ω–∞ GPU
```

### 2. Streaming Responses
```typescript
// –ó–∞–º—ñ—Å—Ç—å —á–µ–∫–∞–Ω–Ω—è –ø–æ–≤–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ - streaming
const response = await fetch(`${routerUrl}/route`, {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({...requestBody, stream: true}),
});

const reader = response.body.getReader();
// –ß–∏—Ç–∞—Ç–∏ —á–∞—Å—Ç–∏–Ω–∞–º–∏ —Ç–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏
```

### 3. –ö–µ—à—É–≤–∞–Ω–Ω—è –ø—Ä–æ–º–ø—Ç—ñ–≤
```yaml
# Router config
cache:
  enabled: true
  ttl: 300  # 5 —Ö–≤–∏–ª–∏–Ω
```

### 4. Lighter Model –¥–ª—è –ø—Ä–æ—Å—Ç–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
```yaml
# –®–≤–∏–¥—à–∞ –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–æ—Å—Ç–∏—Ö –ø–∏—Ç–∞–Ω—å
llm_profiles:
  local_qwen3_3b:  # –®–≤–∏–¥—à–∞, –º–µ–Ω—à–∞ –º–æ–¥–µ–ª—å
    provider: ollama
    model: qwen2.5:3b-instruct-q4_K_M
    timeout_ms: 10000
```

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:
- ‚ùå –¢–∞–π–º–∞—É—Ç –ø—ñ—Å–ª—è 15 —Å–µ–∫—É–Ω–¥
- ‚ùå –í—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç—å –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- ‚ùå –°–ø—ñ–Ω–µ—Ä –∫—Ä—É—Ç–∏—Ç—å—Å—è –±–µ–∑–∫—ñ–Ω–µ—á–Ω–æ

### –ü—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:
- ‚úÖ –¢–∞–π–º–∞—É—Ç 30 —Å–µ–∫—É–Ω–¥
- ‚úÖ –í—ñ–¥–ø–æ–≤—ñ–¥—å –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –∑–∞ 15-20 —Å–µ–∫—É–Ω–¥
- ‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∞–≥–µ–Ω—Ç–∞

---

## üìù –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

–õ–æ–≥–∏ Router –ø–æ–∫–∞–∑—É—é—Ç—å —É—Å–ø—ñ—à–Ω—É –æ–±—Ä–æ–±–∫—É:
```
INFO: Request successful via llm_local_qwen3_8b
INFO: Tokens: 416 (43 prompt + 373 completion)
INFO: 145.224.94.89:27620 - "POST /route HTTP/1.1" 200 OK
```

---

## ‚úÖ –í–∏—Å–Ω–æ–≤–æ–∫

–ü—Ä–æ–±–ª–µ–º–∞ –±—É–ª–∞ –Ω–µ –≤ Router –∞–±–æ LLM, –∞ –≤ –∑–∞–Ω–∞–¥—Ç–æ –∫–æ—Ä–æ—Ç–∫–æ–º—É —Ç–∞–π–º–∞—É—Ç—ñ frontend. –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –¥–æ 30 —Å–µ–∫—É–Ω–¥ –≤–∏—Ä—ñ—à—É—î –ø—Ä–æ–±–ª–µ–º—É –¥–ª—è –≤—Å—ñ—Ö –∞–≥–µ–Ω—Ç—ñ–≤-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤.

–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–∏—Å–∫–æ—Ä–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ - —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è:
1. –ü–æ–≤–Ω–µ GPU acceleration –¥–ª—è Ollama
2. Streaming responses —É frontend
3. –õ–µ–≥—à—ñ –º–æ–¥–µ–ª—ñ –¥–ª—è –ø—Ä–æ—Å—Ç–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤




