# üìä –ü–æ–≤–Ω–∏–π —Å—Ç–∞—Ç—É—Å —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π - –î–µ—Ç–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç

**–î–∞—Ç–∞**: 2025-11-18  
**–°–µ—Ä–≤–µ—Ä**: 144.76.224.179 (Node 1)

---

## ‚úÖ –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 1: Node Registry

### –°—Ç–∞—Ç—É—Å:
- ‚ö†Ô∏è **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω–∏–π**, –∞–ª–µ API –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î
- ‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö** `node_registry` —Å—Ç–≤–æ—Ä–µ–Ω–∞
- ‚úÖ **–¢–∞–±–ª–∏—Ü—ñ** —Å—Ç–≤–æ—Ä–µ–Ω—ñ –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º enum —Ç–∏–ø–æ–º
- ‚è≥ **–ü–æ—Ç—Ä—ñ–±–Ω–æ**: –î–æ—á–µ–∫–∞—Ç–∏—Å—è –ø–æ–≤–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç—É

### –©–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:
- ‚úÖ Node Registry Service –∫–æ–¥ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω–æ
- ‚úÖ Dockerfile –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ
- ‚úÖ docker-compose.yml –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –≥–æ—Ç–æ–≤–∞

### –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:
1. –î–æ—á–µ–∫–∞—Ç–∏—Å—è –ø–æ–≤–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç—É Node Registry
2. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ Node 1 (—Å–µ—Ä–≤–µ—Ä):
   ```bash
   python3 -m tools.dagi_node_agent.bootstrap \
     --role router-node \
     --labels gpu,server,heavy \
     --registry-url http://localhost:9205
   ```
3. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ Node 2 (–Ω–æ—É—Ç–±—É–∫):
   ```bash
   python3 -m tools.dagi_node_agent.bootstrap \
     --role heavy-vision-node \
     --labels gpu,home,mac \
     --registry-url http://144.76.224.179:9205
   ```

---

## ‚ö†Ô∏è –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 2: RAG Haystack Service

### –°—Ç–∞—Ç—É—Å:
- ‚ùå **–ù–ï –ü–†–ê–¶–Æ–Ñ** - SyntaxError: `await` outside async function
- **–§–∞–π–ª**: `services/rag-service/app/ingest_pipeline.py:87`
- **–ü—Ä–æ–±–ª–µ–º–∞**: `await publish_document_ingested()` –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –≤ –Ω–µ-async —Ñ—É–Ω–∫—Ü—ñ—ó

### –©–æ —î:
- ‚úÖ –ö–æ–¥ RAG Service —ñ—Å–Ω—É—î
- ‚úÖ Haystack 2.x —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è
- ‚úÖ Document Store (pgvector)
- ‚úÖ Embedding service
- ‚úÖ Query pipeline

### –©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏:
```python
# services/rag-service/app/ingest_pipeline.py:87
# –ü–†–û–ë–õ–ï–ú–ê:
await publish_document_ingested(...)  # await –≤ –Ω–µ-async —Ñ—É–Ω–∫—Ü—ñ—ó

# –†–Ü–®–ï–ù–ù–Ø:
# –í–∞—Ä—ñ–∞–Ω—Ç 1: –ó—Ä–æ–±–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é async
async def ingest_parsed_document(...):
    ...
    await publish_document_ingested(...)

# –í–∞—Ä—ñ–∞–Ω—Ç 2: –í–∏–∫–ª–∏–∫–∞—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ (—è–∫—â–æ publish_document_ingested —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞)
publish_document_ingested(...)
```

### –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è:
- ‚ö†Ô∏è **–ù–µ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–æ** –≤ Router
- ‚ö†Ô∏è **–ù–µ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–æ** –∑ Memory Service
- ‚ö†Ô∏è **–ù–µ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–æ** –∑ Parser Service

---

## üîç –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 3: –ë–∞–∑–∏ –¥–∞–Ω–∏—Ö –¥–ª—è –∞–≥–µ–Ω—Ç—ñ–≤

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞:

#### **Qdrant** (Vector DB):
- ‚ö†Ô∏è **API –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î** (–ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –∑–∞–ø—É—â–µ–Ω–∏–π)
- ‚ùå **–ù–µ–º–∞—î –æ–∫—Ä–µ–º–∏—Ö –∫–æ–ª–µ–∫—Ü—ñ–π** –¥–ª—è –∞–≥–µ–Ω—Ç—ñ–≤
- **–ü–æ—Ç—Ä—ñ–±–Ω–æ**: –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–ª–µ–∫—Ü—ñ—ó `daarwizz_docs`, `helion_docs`, `greenfood_docs`

#### **Neo4j** (Graph DB):
- ‚úÖ **–ü—Ä–∞—Ü—é—î** (ports 7474, 7687)
- ‚ùå **–ù–µ–º–∞—î —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó** –≤ –∫–æ–¥—ñ
- ‚ùå **–ù–µ–º–∞—î –æ–∫—Ä–µ–º–∏—Ö –±–∞–∑ –¥–∞–Ω–∏—Ö** –¥–ª—è –∞–≥–µ–Ω—Ç—ñ–≤
- **–ü–æ—Ç—Ä—ñ–±–Ω–æ**: 
  - –°—Ç–≤–æ—Ä–∏—Ç–∏ Neo4j client
  - –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ –¥–æ Router
  - –°—Ç–≤–æ—Ä–∏—Ç–∏ –±–∞–∑–∏: `daarwizz_graph`, `helion_graph`, `greenfood_graph`

#### **Milvus**:
- ‚ùå **–ó—É–ø–∏–Ω–µ–Ω–∏–π** (–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è)
- **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞**: Qdrant –ø—Ä–∞—Ü—é—î

#### **PostgreSQL**:
- ‚úÖ **–ü—Ä–∞—Ü—é—î** (`dagi-postgres`)
- ‚úÖ **pgvector** –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ—à—É–∫—É
- ‚ö†Ô∏è **–ù–µ–º–∞—î –æ–∫—Ä–µ–º–∏—Ö —Ç–∞–±–ª–∏—Ü—å** –¥–ª—è –∞–≥–µ–Ω—Ç—ñ–≤
- **–ü–æ—Ç—Ä—ñ–±–Ω–æ**: –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–∞–±–ª–∏—Ü—ñ `daarwizz_docs`, `helion_docs`, `greenfood_docs`

---

## üìã –î–µ—Ç–∞–ª—å–Ω–∏–π –ø–ª–∞–Ω –¥—ñ–π

### **Phase 1: Node Registry** (30 —Ö–≤) üî¥

1. ‚è≥ –î–æ—á–µ–∫–∞—Ç–∏—Å—è —Å—Ç–∞—Ä—Ç—É Node Registry
2. ‚è≥ –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ Node 1 (—Å–µ—Ä–≤–µ—Ä)
3. ‚è≥ –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ Node 2 (–Ω–æ—É—Ç–±—É–∫)
4. ‚è≥ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ –Ω–æ–¥

### **Phase 2: RAG Service Fix** (30 —Ö–≤) üî¥

1. ‚è≥ –í–∏–ø—Ä–∞–≤–∏—Ç–∏ `await` –ø–æ–º–∏–ª–∫—É –≤ `ingest_pipeline.py`
2. ‚è≥ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ `events.py` - —á–∏ `publish_document_ingested` async?
3. ‚è≥ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ RAG Service
4. ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ `/ingest` —Ç–∞ `/query` endpoints

### **Phase 3: CrewAI + Crawl4AI** (45 —Ö–≤) üî¥

1. ‚è≥ –°—Ç–≤–æ—Ä–∏—Ç–∏ CrewAI tool –¥–ª—è Crawl4AI
2. ‚è≥ –î–æ–¥–∞—Ç–∏ –¥–æ GREENFOOD –∞–≥–µ–Ω—Ç—ñ–≤
3. ‚è≥ –î–æ–¥–∞—Ç–∏ –¥–æ —ñ–Ω—à–∏—Ö –∞–≥–µ–Ω—Ç—ñ–≤ (DAARWIZZ, Helion)
4. ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ web search

### **Phase 4: Neo4j Integration** (1 –≥–æ–¥) üü°

1. ‚è≥ –°—Ç–≤–æ—Ä–∏—Ç–∏ Neo4j client (`utils/neo4j_client.py`)
2. ‚è≥ –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ –¥–æ Router
3. ‚è≥ –°—Ç–≤–æ—Ä–∏—Ç–∏ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –¥–ª—è –∞–≥–µ–Ω—Ç—ñ–≤
4. ‚è≥ –ó–±–µ—Ä—ñ–≥–∞—Ç–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó (user ‚Üî agent ‚Üî documents)
5. ‚è≥ –í—ñ–∑—É–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≥—Ä–∞—Ñ

### **Phase 5: –û–∫—Ä–µ–º—ñ –ë–î –¥–ª—è –∞–≥–µ–Ω—Ç—ñ–≤** (2 –≥–æ–¥) üü°

#### **Qdrant**:
1. ‚è≥ –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–ª–µ–∫—Ü—ñ—ó –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞:
   - `daarwizz_documents`
   - `helion_documents`
   - `greenfood_documents`
2. ‚è≥ –û–Ω–æ–≤–∏—Ç–∏ RAG Service –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ–∫—Ä–µ–º–∏—Ö –∫–æ–ª–µ–∫—Ü—ñ–π

#### **Neo4j**:
1. ‚è≥ –°—Ç–≤–æ—Ä–∏—Ç–∏ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:
   - `daarwizz_graph`
   - `helion_graph`
   - `greenfood_graph`
2. ‚è≥ –Ü–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ –≤ Router –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤–∑–∞—î–º–æ–¥—ñ–π

#### **PostgreSQL**:
1. ‚è≥ –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–∞–±–ª–∏—Ü—ñ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞:
   - `daarwizz_rag_documents`
   - `helion_rag_documents`
   - `greenfood_rag_documents`
2. ‚è≥ –û–Ω–æ–≤–∏—Ç–∏ RAG Service –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ–∫—Ä–µ–º–∏—Ö —Ç–∞–±–ª–∏—Ü—å

---

## üéØ –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∏

### üî¥ **–í–ò–°–û–ö–ò–ô**:
1. **Node Registry** - –∑–∞–≤–µ—Ä—à–∏—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
2. **RAG Service** - –≤–∏–ø—Ä–∞–≤–∏—Ç–∏ –ø–æ–º–∏–ª–∫—É
3. **CrewAI + Crawl4AI** - web search

### üü° **–°–ï–†–ï–î–ù–Ü–ô**:
4. **Neo4j Integration** - –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ –¥–æ Router
5. **–û–∫—Ä–µ–º—ñ –ë–î –¥–ª—è –∞–≥–µ–Ω—Ç—ñ–≤** - Qdrant, Neo4j, PostgreSQL

### üü¢ **–ù–ò–ó–¨–ö–ò–ô**:
6. Streaming TTS
7. Grafana Alerts

---

## üìä –ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ì–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å | –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç |
|-----------|--------|-----------|-----------|
| **Node Registry** | ‚ö†Ô∏è –ó–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è | üü° 80% | üî¥ –í–∏—Å–æ–∫–∏–π |
| **RAG Haystack** | ‚ùå –ü–æ–º–∏–ª–∫–∞ | üî¥ 0% | üî¥ –í–∏—Å–æ–∫–∏–π |
| **CrewAI + Crawl4AI** | ‚è≥ –ù–µ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–æ | üü° 0% | üî¥ –í–∏—Å–æ–∫–∏–π |
| **Neo4j** | ‚úÖ –ü—Ä–∞—Ü—é—î | üü¢ 100% | üü° –°–µ—Ä–µ–¥–Ω—ñ–π |
| **Qdrant** | ‚ö†Ô∏è –ù–µ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ | üü° ? | üü° –°–µ—Ä–µ–¥–Ω—ñ–π |
| **–û–∫—Ä–µ–º—ñ –ë–î –∞–≥–µ–Ω—Ç—ñ–≤** | ‚ùå –ù–µ–º–∞—î | üî¥ 0% | üü° –°–µ—Ä–µ–¥–Ω—ñ–π |

---

*–°—Ç–≤–æ—Ä–µ–Ω–æ: 2025-11-18*  
*–û–Ω–æ–≤–ª–µ–Ω–æ: –ø—ñ—Å–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞—É–¥–∏—Ç—É*

